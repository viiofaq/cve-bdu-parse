import psycopg2

with open("settings.txt", 'r') as fp:
    txt_lines = [1, 4, 7, 10, 13]
    lines = []
    for i, line in enumerate(fp):
        if i in txt_lines:
            lines.append(line.strip())


dbname = lines[0]
user = lines[1]
password = lines[2]
host = lines[3]

conn = psycopg2.connect(dbname=dbname, user=user,
                        password=password, host=host)
cursor = conn.cursor()

cursor.execute("INSERT INTO summarinfo (identificator, otherids, datepublished, cvss, software, softwareversion, "
               "description, cwe, links) SELECT bduid, otherids,"
               "datepublished, cvss, software, softwareversion, description, cwe, links FROM bdulist")

cursor.execute("INSERT INTO summarinfo (identificator, datepublished, cvss, software, softwareversion, "
               "description, cwe, links) SELECT cveid,"
               "datepublished, cvss, software, softwareversion, description, cwe, links FROM cvelist")

cursor.execute("DELETE FROM summarinfo a WHERE a.ctid <> (SELECT min(b.ctid) FROM summarinfo b WHERE  a.identificator "
               "= b.identificator);")

cursor.execute('truncate table bdulist')
cursor.execute('truncate table cvelist')

#print("MOVE DONE")

conn.commit()
cursor.close()
conn.close()